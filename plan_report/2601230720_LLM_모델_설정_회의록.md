# LLM 모델 설정 회의록

> **문서 ID**: 2601230720  
> **작성일**: 2026-01-23  
> **회의 주제**: rag.answer 대체 모델 설정 추가  
> **참석자**: LLM 통합 전문가, 코드 아키텍트, 레드팀 리뷰어

---

## 📋 요청 사항 정리

### 사용자 요청

`llm-usage-map.ts`의 `rag.answer` 설정에 **주석 처리된 대체 모델 설정**을 추가하여, 상황에 따라 쉽게 모델을 변경할 수 있도록 함.

**추가할 모델:**

1. **OpenAI GPT-5.2** (현재 `gpt-5.2-2025-12-11`로 등록됨)
2. **Anthropic Claude 4.5 Sonnet** (현재 `claude-4.5-sonnet-20250929`로 등록됨)

---

## 👨‍💻 전문가 패널 소개

### 🔵 전문가 A: LLM 통합 전문가

> 안녕하세요, 저는 PRISM Writer의 LLM 통합 아키텍트입니다.
> 다중 LLM Provider 통합 및 Gateway 시스템을 설계했습니다.

### 🔵 전문가 B: 코드 아키텍트

> 안녕하세요, 저는 코드베이스 전체 구조를 담당하는 아키텍트입니다.
> 타입 시스템과 설정 관리 패턴을 설계했습니다.

### 🔴 전문가 C: 레드팀 리뷰어

> 안녕하세요, 저는 레드팀에서 보안 및 안정성 검토를 담당합니다.
> 제안된 변경의 리스크와 부작용을 분석합니다.

---

## 🔍 현재 상태 분석

### 1. llm-usage-map.ts (현재 rag.answer 설정)

```typescript
// 현재 코드 (lines 100-111)
'rag.answer': {
  modelId: 'gemini-3-flash-preview',  // ← 현재 Primary 모델
  fallback: 'gpt-5-mini',             // ← Fallback 모델
  maxTokens: 2700,
  description: 'RAG 기반 답변 생성',
  generationConfig: {
    temperature: 0.9,
    topP: 0.95,
    topK: 40,
  },
},
```

### 2. 등록된 모델 확인 (models.ts)

| 모델 ID                      | Provider  | Display Name             | 상태    |
| ---------------------------- | --------- | ------------------------ | ------- |
| `gemini-3-flash-preview`     | gemini    | Gemini 3.0 Flash Preview | ✅ 활성 |
| `gpt-5.2-2025-12-11`         | openai    | GPT-5.2                  | ✅ 활성 |
| `claude-4.5-sonnet-20250929` | anthropic | Claude 4.5 Sonnet        | ✅ 활성 |

### 3. Provider 지원 확인

| Provider  | 파일                     | 환경 변수           | 상태      |
| --------- | ------------------------ | ------------------- | --------- |
| Gemini    | `providers/gemini.ts`    | `GOOGLE_API_KEY`    | ✅ 구현됨 |
| OpenAI    | `providers/openai.ts`    | `OPENAI_API_KEY`    | ✅ 구현됨 |
| Anthropic | `providers/anthropic.ts` | `ANTHROPIC_API_KEY` | ✅ 구현됨 |

---

## 💡 전문가 A 제안: 구현 방안

### 코드 변경안

```typescript
// ---------------------------------------------------------------------------
// RAG Pipeline
// ---------------------------------------------------------------------------
'rag.answer': {
  modelId: 'gemini-3-flash-preview',
  fallback: 'gpt-5-mini',
  maxTokens: 2700,
  description: 'RAG 기반 답변 생성',
  // [Creative] 창의적 생성 구간
  generationConfig: {
    temperature: 0.9,
    topP: 0.95,
    topK: 40,
  },
},

// ===========================================================================
// [ALTERNATIVE MODELS] 대체 모델 설정 (주석 해제하여 사용)
// ===========================================================================
//
// ┌─────────────────────────────────────────────────────────────────────────┐
// │  [Option 1] OpenAI GPT-5.2                                             │
// │  - 장점: 최신 Reasoning 능력, 긴 컨텍스트 (400K)                        │
// │  - 단점: 비용 높음 ($1.75/1M input, $14/1M output)                     │
// │  - 사용 시: 아래 주석 해제 후 위의 Gemini 설정 주석 처리                 │
// └─────────────────────────────────────────────────────────────────────────┘
// 'rag.answer': {
//   modelId: 'gpt-5.2-2025-12-11',
//   fallback: 'gemini-3-flash-preview',
//   maxTokens: 2700,
//   description: 'RAG 기반 답변 생성 (OpenAI GPT-5.2)',
//   generationConfig: {
//     temperature: 0.9,
//     topP: 0.95,
//     // topK: OpenAI 미지원
//   },
// },
//
// ┌─────────────────────────────────────────────────────────────────────────┐
// │  [Option 2] Anthropic Claude 4.5 Sonnet                                │
// │  - 장점: 높은 안정성, 좋은 한국어 지원                                   │
// │  - 단점: Gemini 대비 비용 높음 ($3/1M input, $15/1M output)             │
// │  - 사용 시: 아래 주석 해제 후 위의 Gemini 설정 주석 처리                 │
// └─────────────────────────────────────────────────────────────────────────┘
// 'rag.answer': {
//   modelId: 'claude-4.5-sonnet-20250929',
//   fallback: 'gemini-3-flash-preview',
//   maxTokens: 2700,
//   description: 'RAG 기반 답변 생성 (Claude 4.5 Sonnet)',
//   generationConfig: {
//     temperature: 0.9,
//     topP: 0.95,
//     topK: 40,  // Anthropic은 topK 지원
//   },
// },
// ===========================================================================
```

---

## 🔵 전문가 B 검토: 코드 아키텍트 의견

### ✅ 긍정적 평가

1. **충돌 없음**: 주석 처리된 코드는 컴파일에 영향 없음
2. **명확한 문서화**: 각 옵션의 장단점이 코드 내 명시됨
3. **환경변수 독립**: 해당 모델 사용 시 필요한 API 키만 설정하면 됨
4. **Fallback 체인 유지**: 대체 모델 사용 시에도 fallback이 설정되어 안정성 확보

### ⚠️ 주의 사항

1. **환경 변수 필요**:
   - OpenAI 사용 시: `OPENAI_API_KEY` 필수
   - Anthropic 사용 시: `ANTHROPIC_API_KEY` 필수

2. **topK 파라미터**:
   - OpenAI는 `topK` 미지원 → 자동 무시됨 (providers/openai.ts에서 처리)
   - Anthropic은 `topK` 지원 → 정상 전달됨

---

## 🔴 레드팀 크로스 체크

### 리스크 분석

| 리스크                    | 심각도  | 설명                                          | 대응                          |
| ------------------------- | ------- | --------------------------------------------- | ----------------------------- |
| 주석 해제 시 중복 키 에러 | 🟡 중간 | `'rag.answer'` 키가 중복되면 마지막 값만 적용 | 기존 설정 주석 처리 필수 안내 |
| API 키 미설정             | 🟢 낮음 | 환경 변수 없으면 Provider 에러 발생           | Gateway Fallback이 처리       |
| 비용 증가                 | 🟢 낮음 | GPT-5.2, Claude는 Gemini보다 비용 높음        | 문서에 비용 명시 완료         |

### 레드팀 판정

✅ **승인** - 안전한 변경입니다. 코드 충돌 없고, 문서화도 충분합니다.

---

## 📝 최종 결정

### 합의 사항

1. **구현 승인**: 전문가 A의 제안대로 주석 처리된 대체 설정 추가
2. **위치**: `rag.answer` 바로 아래, `rag.reviewer` 이전
3. **형식**: 박스 주석으로 각 옵션 구분

### 구현 체크리스트

- [ ] P1: `llm-usage-map.ts`에 OpenAI 대체 설정 주석 추가
- [ ] P2: `llm-usage-map.ts`에 Anthropic 대체 설정 주석 추가
- [ ] P3: 각 옵션에 장단점 및 사용법 주석 추가
- [ ] P4: 환경 변수 요구사항 명시

### 영향받는 파일

| 파일                                   | 변경 유형        |
| -------------------------------------- | ---------------- |
| `frontend/src/config/llm-usage-map.ts` | 수정 (주석 추가) |

---

## ✅ 검증 방법

### 자동 검증

```bash
# TypeScript 컴파일 에러 확인
npm run build
```

### 수동 검증 (모델 전환 테스트)

1. 주석 해제하여 OpenAI 또는 Anthropic으로 전환
2. 환경 변수 설정: `OPENAI_API_KEY` 또는 `ANTHROPIC_API_KEY`
3. 채팅 테스트 후 Vercel 로그에서 모델 확인:
   ```
   [Chat API] Starting LLM stream with model: gpt-5.2-2025-12-11
   ```

---

## 📎 참고

### 환경 변수 설정 예시

```bash
# Vercel Environment Variables

# 기본 (Gemini)
GOOGLE_API_KEY=AIzaSy...

# OpenAI 사용 시 추가
OPENAI_API_KEY=sk-proj-...

# Anthropic 사용 시 추가
ANTHROPIC_API_KEY=sk-ant-...
```

---

> **회의 종료: 2026-01-23 07:20**  
> **다음 단계**: 코드 적용 진행
