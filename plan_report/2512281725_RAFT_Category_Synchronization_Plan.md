# 🔗 RAFT & 문서 카테고리 동기화 설계서

**작성일**: 2025-12-28
**목표**: RAFT 합성 데이터 생성 시, 기존 "내 문서" 및 "참고 자료"의 카테고리(예: `250621_예민2_풀링`)를 그대로 사용하여 데이터의 연관성을 확보하는 것.

---

## 1. 요구사항 분석 (이해 검증)

디렉터님의 요청은 **"RAFT 생성 시스템(Admin)"과 "기존 문서 관리 시스템(Editor/Sidebar)"의 분류 체계를 하나로 연결하라"**는 것입니다.

### 🔍 현재 상황 (AS-IS)

1.  **RAFT 카테고리**: `Marketing`, `Tech` 등 코드에 하드코딩된 **고정(Static) 카테고리**만 선택 가능.
2.  **문서 카테고리**: 사용자가 에디터에서 자유롭게 입력한 **동적(Dynamic) 카테고리** (예: `250621_예민2_풀링`).
3.  **문제점**: "참고 자료"에 업로드된 문서를 바탕으로 RAFT 데이터를 만드는데, 정작 RAFT 데이터는 엉뚱한 고정 카테고리(`기타` 등)로 분류되어 **데이터의 맥락(Context)이 끊어짐.**

### 🎯 목표 상황 (TO-BE)

1.  **카테고리 통합**: RAFT 데이터 생성 시, **현재 DB에 존재하는 문서 카테고리 목록**을 불러와 선택할 수 있어야 함.
2.  **데이터 연결**: RAFT 데이터가 `250621_예민2_풀링` 같은 실제 프로젝트명을 달고 저장되어야, 나중에 해당 프로젝트를 위한 파인튜닝 데이터로 활용 가능.
3.  **참고 자료 연동**: (궁극적으로) 해당 카테고리를 선택하면, 그 카테고리에 속한 문서들의 내용을 자동으로 "Context"로 불러오는 기능까지 확장 가능성 열어둠.

---

## 2. 기술적 해결 방안

이 기능을 구현하기 위해 다음 3단계 작업이 필요합니다.

### Phase 1: 동적 카테고리 페치 (Dynamic Category Fetching)

- **현재**: `RAFT_CATEGORIES` 상수 배열 사용.
- **변경**:
  - `articles` (또는 `documents`) 테이블에서 `DISTINCT category` 목록을 조회하는 API 필요.
  - 또는 기존 문서 목록 조회 API를 활용하여 클라이언트에서 유니크한 카테고리 추출.

### Phase 2: UI 업그레이드 (Select to Combobox)

- **현재**: 단순 `<select>` 드롭다운.
- **변경**: **Combobox (또는 Creatable Select)** 형태로 변경.
  - 1. 기존 문서 카테고리 목록을 드롭다운으로 보여줌.
  - 2. 사용자가 직접 새 카테고리를 입력(“직접 입력”)할 수도 있게 함.
  - 3. `RAFT_CATEGORIES`(고정)와 `User_Categories`(동적)를 합쳐서 보여줌.

### Phase 3: 데이터 흐름 통합

- `SyntheticDataPanel`에서 선택된 동적 카테고리 값을 `generateSyntheticDataAPI`로 전달.
- DB의 `raft_dataset` 테이블 `category` 컬럼은 이미 `TEXT` 타입이므로, 별도 마이그레이션 없이 즉시 저장 가능.

---

## 3. 구현 체크리스트

### Backend / Database

- [ ] **API 수정**: 문서의 고유 카테고리 목록을 조회하는 API 엔드포인트 생성 (또는 기존 API 활용).
  - 예: `GET /api/documents/categories`

### Frontend (UI/UX)

- [ ] **CategorySelect 컴포넌트 고도화**:
  - `admin/raft/CategorySelect.tsx` (가칭) 분리 및 생성.
  - SWR 또는 React Query로 실시간 카테고리 목록 로드.
  - "기존 카테고리에서 선택" vs "새 카테고리 입력" 하이브리드 UI 구현.
- [ ] **SyntheticDataPanel 연동**:
  - 하드코딩된 `RAFT_CATEGORIES` 대신 위 컴포넌트 사용.

### Verification

- [ ] 실제 문서(`250621_예민2_풀링`) 카테고리가 RAFT 생성 화면 드롭다운에 뜨는지 확인.
- [ ] 해당 카테고리로 생성 시, 목록 필터에서도 동일하게 필터링되는지 확인.

---

## 4. 디렉터님 확인 요청

위 분석 내용이 디렉터님의 의도와 정확히 일치하는지 확인 부탁드립니다.
승인해주시면 즉시 **Phase 1: 동적 카테고리 목록 조회 구현**부터 시작하겠습니다.
