# 📌 파이프라인 아이디어 회의(재정리) + 크로스체크 + 우선순위 “투표” 결과

<!--
회의 참여 전문가(역할)
- 시니어 개발자(사회)
- LLM/RAG 아키텍트(시니어)
- 정보검색(IR)·검색 엔지니어
- 데이터 엔지니어
- 평가(Evaluation) 전문가
- QA 리드(회귀테스트/품질게이트)
- 보안/개인정보(Privacy/Security) 전문가
- Observability/Telemetry 전문가(로그·지표)
- MLOps/SRE(운영/비용)
- 프론트엔드 리드
- UX 라이터/콘텐츠 디자이너
- PM(제품 매니저)
- Search Relevance / Ranking Scientist(랭킹·리랭킹)
-->

> **[팩트]** 지금까지 합의된 파이프라인 핵심:  
**루브릭별 Retrieval → (하이브리드/리랭킹) → Evidence Pack → Judge(JSON/근거강제) → Citation/Consistency Gate → Telemetry(run_id) → 개선 루프**

> **[내 생각]** 아래 “투표”는 실제 팀이 있는 상황을 가정해 **각 역할 관점에서 우선순위를 매긴 회의 내 합의형 시뮬레이션**입니다(의사결정용).

---

## 1) 파이프라인 아이디어 목록(회의에서 나온 것만)
1. **ACL/Namespace + Retrieval 단계 권한 필터(게이트 강제)**
2. **루브릭 시스템(버전) + 루브릭별 쿼리 생성**
3. **루브릭 항목별 별도 Retrieval(Top-K 분리 회수)**
4. **하이브리드 검색(BM25+벡터) + 리랭커(Top 후보 제한)**
5. **Evidence Pack 표준화**(루브릭별 근거 묶음: chunk_id/인용후보/메타)
6. **Judge Contract**(JSON 스키마 고정 + 근거 인용 강제 + 근거 없으면 ‘근거 부족’)
7. **Citation Gate**(인용이 원문에 실제 존재하는지 검증)
8. **Consistency Gate + 골드셋 회귀테스트**(점수 튐/근거 불일치 방지)
9. **Telemetry**(run_id 트레이스 + 핵심 지표 대시보드)
10. **비용 가드레일**(캐시/쿼터/레이트리밋, 리랭커 K 제한)
11. **Hard Negative 자산화**(자주 뜨는 오답 근거 수집 → 튜닝/회귀테스트)
12. **(Phase 1.5) Category/Difficulty 태깅**(검증 루프 포함)
13. **(v1) 모드 프롬프트 모듈화**(코칭/교정/채점표)

---

## 2) 크로스체크(서로 검증해서 나온 “충돌/보완” 정리)

### A. 품질 vs 비용 충돌
- **충돌:** 리랭커/다중평가/복수쿼리 → 품질↑ / 비용·지연↑  
- **합의 보완:**  
  - 리랭커는 **Top 15~20 후보만**  
  - Judge 다중평가는 **옵션(문제 케이스/유료 플랜)**  
  - 캐시/쿼터를 **P0로 동시 도입**

### B. “근거 부족” UX 문제
- **충돌:** 근거 없으면 판단 금지 → 안전↑ / 사용자는 답답  
- **합의 보완:**  
  - “근거 부족” 출력 시 **부족한 챕터/필요한 자료**를 안내(코칭형 UX)

### C. 루브릭의 모호함이 파이프라인을 흔드는 문제
- **충돌:** 루브릭이 추상적이면 검색/채점/테스트가 다 흔들림  
- **합의 보완:**  
  - 루브릭을 **관측 가능한 체크포인트**로 재정의(예시/반례 포함)

---

## 3) 우선순위 투표 결과(역할별 검증 후)

### 투표 방식
- 참여자(개발/운영 측 포함): **13명**  
  *(시니어/아키텍트/IR/데이터/Eval/QA/보안/텔레메트리/SRE/프론트/UX라이터/PM/랭킹사이언티스트)*  
- 각자 “지금 당장 파이프라인에 박아야 할 것” 기준으로 선택 → **득표수 집계**

### 득표 Top 리스트
| 항목 | 득표(13명 중) | 코멘트(요약) |
|---|---:|---|
| 1) **ACL/Namespace + Retrieval 필터 게이트** | **13** | 유출 방지(검색 시점에 강제) |
| 6) **Judge Contract(JSON+근거강제+근거부족)** | **12** | 품질/재현성의 뼈대 |
| 2+3) **루브릭+루브릭별 쿼리/별도 Retrieval** | **12** | 평가 서비스의 본질 |
| 4) **하이브리드 + 리랭커(K 제한)** | **11** | 근거 회수율 실질 개선 |
| 7) **Citation Gate(인용 검증)** | **10** | “근거 기반” 신뢰 확보 |
| 9) **Telemetry(run_id + 핵심지표)** | **9** | 병목/실패 지점 추적 |
| 8) **Consistency Gate + 골드셋 회귀** | **8** | 릴리즈 안정성 |
| 10) **캐시/쿼터/레이트리밋** | **8** | 비용 폭발 방지 |
| 5) **Evidence Pack 표준화** | **7** | Judge 입력 안정화 |
| 11) **Hard Negative 자산화** | **6** | 튜닝/회귀에 강력 |
| 13) **모드 프롬프트(코칭/교정/채점)** | **5** | UX/상품성 강화 |
| 12) **Category/Difficulty 태깅** | **3** | Phase 1.5 이후 권장 |

---

## 4) 최종 우선순위 결론(P0/P1/P2)

### ✅ P0 (바로 구현: 파이프라인 “필수 골격”)
- **ACL/Namespace + Retrieval 필터 게이트**
- **루브릭 시스템(버전) + 루브릭별 쿼리 생성 + 항목별 Retrieval**
- **하이브리드(BM25+벡터) + 리랭커(Top 후보 제한)**
- **Judge Contract(JSON 고정 + 근거 인용 강제 + 근거 없으면 근거 부족)**
- **Citation Gate(인용 원문 검증)**

### ▶️ P1 (운영 안정화/성능 고도화)
- **Telemetry(run_id + 핵심지표 대시보드)**
- **Consistency Gate + 골드셋 회귀테스트**
- **캐시/쿼터/레이트리밋**
- **Evidence Pack 표준화**
- **Hard Negative 수집/활용**

### 🧩 P2 (상품성/확장)
- **모드 프롬프트(코칭/교정/채점표)**
- **Category/Difficulty 태깅(검증 루프 포함)**

---

## 5) 다음 회의 진행(결정해야 할 3가지)
1) **P0 구현 순서 확정**(게이트→검색→Judge→인용검증 순 추천)  
2) **Retrieval 계약서/ Judge 계약서/ Eval(게이트) 계약서** 3종 문서화  
3) **P0 성공 기준 숫자**(예: 근거부족률 목표, 인용검증 실패율 목표, P95 응답시간/비용 상한)
