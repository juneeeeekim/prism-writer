# RAG í™˜ê° ë‹µë³€ ê°œì„  ì²´í¬ë¦¬ìŠ¤íŠ¸

> **ì‘ì„±ì¼**: 2025-12-27
> **ê·¼ê±° ë¬¸ì„œ**: [2512271030_RAG_Hallucination_Meeting.md](./2512271030_RAG_Hallucination_Meeting.md) > **ëª©ì **: PRISM Writer RAG ì‹œìŠ¤í…œì˜ í™˜ê° ë‹µë³€ ë¬¸ì œ í•´ê²°

---

## ğŸ“ íŒŒì¼ êµ¬ì„± ê²°ì •

### ì„ íƒ: ë‹¨ì¼ í†µí•© íŒŒì¼

| ê³ ë ¤ ì˜µì…˜            | ì¥ì                                                   | ë‹¨ì                   |
| -------------------- | ----------------------------------------------------- | --------------------- |
| ë‹¨ì¼ íŒŒì¼ âœ…         | ì „ì²´ ì§„í–‰ ìƒí™© í•œëˆˆì— íŒŒì•…, Phase ê°„ ì˜ì¡´ì„± ëª…ì‹œ ìš©ì´ | ë¬¸ì„œê°€ ê¸¸ì–´ì§ˆ ìˆ˜ ìˆìŒ |
| 2ê°œ íŒŒì¼ (ë‹¨ê¸°/ì¥ê¸°) | ì—­í•  ë¶„ë¦¬ ëª…í™•                                        | ì˜ì¡´ì„± ì¶”ì  ì–´ë ¤ì›€    |
| 4ê°œ íŒŒì¼ (Phaseë³„)   | ë‹´ë‹¹ìë³„ ë¶„ë¦¬                                         | ê´€ë¦¬ ë³µì¡ë„ ì¦ê°€      |

### ê·¼ê±°

1. **í˜‘ì—… íš¨ìœ¨**: ì‹œë‹ˆì–´/ì£¼ë‹ˆì–´/UX ì „ë¬¸ê°€ê°€ ë™ì¼ ë¬¸ì„œì—ì„œ ì§„í–‰ ìƒí™© ê³µìœ 
2. **ì—°ê²°ì„±**: Phase ê°„ ì˜ì¡´ì„±ì´ ìˆì–´ ë‹¨ì¼ ë¬¸ì„œê°€ ì¶”ì ì— ìœ ë¦¬
3. **ê²€ì¦ ìš©ì´**: ê° Phase ëì— ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸ í¬í•¨ìœ¼ë¡œ ë…ë¦½ ê²€ì¦ ê°€ëŠ¥

---

## ğŸ¯ ì „ì²´ ë¡œë“œë§µ

```
Phase 1 (ì¦‰ì‹œ: 1-2ì¼)
â”œâ”€â”€ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ê°•í™”
â””â”€â”€ Chain of Thought ì¶”ê°€
        â†“
Phase 2 (ë‹¨ê¸°: 1-2ì£¼)
â”œâ”€â”€ Query Expansion êµ¬í˜„
â”œâ”€â”€ ë™ì  ì„ê³„ê°’ ì¡°ì •
â””â”€â”€ ë¬¸ì„œ ë©”íƒ€ë°ì´í„° ê°œì„ 
        â†“
Phase 3 (ì¤‘ê¸°: 2-4ì£¼)
â”œâ”€â”€ Bad Case ìˆ˜ì§‘ ì‹œìŠ¤í…œ
â””â”€â”€ í™˜ê° íƒì§€ ìë™í™”
        â†“
Phase 4 (ì¥ê¸°: 1-2ê°œì›”)
â””â”€â”€ RAFT íŒŒì¸íŠœë‹ ì¤€ë¹„
```

---

## ğŸ‘¥ ë‹´ë‹¹ì ë°°ì •

| ì—­í•               | Phase 1 | Phase 2  | Phase 3 | Phase 4 |
| ----------------- | ------- | -------- | ------- | ------- |
| **ì‹œë‹ˆì–´ ê°œë°œì** | ë¦¬ë·°    | ì•„í‚¤í…ì²˜ | ì„¤ê³„    | ê³„íš    |
| **ì£¼ë‹ˆì–´ ê°œë°œì** | êµ¬í˜„    | êµ¬í˜„     | êµ¬í˜„    | ë°ì´í„°  |
| **UX/UI ì „ë¬¸ê°€**  | -       | -        | UI ì„¤ê³„ | -       |

---

# Phase 1: ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ê°•í™” (ì¦‰ì‹œ ì ìš©)

## âš ï¸ ì˜í–¥ë°›ì„ ìˆ˜ ìˆëŠ” ê¸°ì¡´ ê¸°ëŠ¥

| ê¸°ëŠ¥               | íŒŒì¼         | ì˜í–¥ ê°€ëŠ¥ì„±                    |
| ------------------ | ------------ | ------------------------------ |
| AI ì±„íŒ… ë‹µë³€ ìƒì„±  | `route.ts`   | ğŸ”´ High - í”„ë¡¬í”„íŠ¸ ë³€ê²½        |
| RAG ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ | `route.ts`   | ğŸŸ¡ Medium - ì»¨í…ìŠ¤íŠ¸ í¬ë§· ë³€ê²½ |
| ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ      | `gateway.ts` | ğŸŸ¢ Low - ë³€ê²½ ì—†ìŒ             |

---

## 1.1 ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ê°œì„ 

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **1.1.1 í˜„ì¬ í”„ë¡¬í”„íŠ¸ ë°±ì—…**

  - íŒŒì¼: `frontend/src/app/api/chat/route.ts`
  - ìœ„ì¹˜: Line 100-112 (systemPrompt ë³€ìˆ˜)
  - ì‘ì—…: ê¸°ì¡´ í”„ë¡¬í”„íŠ¸ë¥¼ ì£¼ì„ìœ¼ë¡œ ë°±ì—…
  - ì—°ê²°ì„±: ë‹¤ìŒ í•­ëª©(1.1.2)ì—ì„œ ìƒˆ í”„ë¡¬í”„íŠ¸ë¡œ êµì²´

- [ ] **1.1.2 ê°œì„ ëœ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì ìš©**

  - íŒŒì¼: `frontend/src/app/api/chat/route.ts`
  - ìœ„ì¹˜: Line 100-112 ëŒ€ì²´
  - ì‘ì—…: íšŒì˜ë¡ 6.2.1 ì„¹ì…˜ì˜ ê°œì„ ëœ í”„ë¡¬í”„íŠ¸ ì ìš©
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] ëª…í™•í•œ ë³€ìˆ˜ëª… (`improvedSystemPrompt` ë˜ëŠ” ê¸°ì¡´ `systemPrompt` ìœ ì§€)
    - [ ] í…œí”Œë¦¿ ë¦¬í„°ëŸ´ ë¬¸ë²• ì˜¤ë¥˜ ì—†ìŒ
    - [ ] í•œê¸€ ì¸ì½”ë”© ë¬¸ì œ ì—†ìŒ
  - ì—°ê²°ì„±: 1.1.1 ë°±ì—… ì™„ë£Œ í›„ ì§„í–‰

- [ ] **1.1.3 í”„ë¡¬í”„íŠ¸ ìƒìˆ˜ ë¶„ë¦¬ (ì„ íƒ)**
  - íŒŒì¼: `frontend/src/config/prompts.ts` (ì‹ ê·œ ìƒì„±)
  - ì‘ì—…: ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ë¥¼ ë³„ë„ ì„¤ì • íŒŒì¼ë¡œ ë¶„ë¦¬
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] export const ì‚¬ìš©
    - [ ] TypeScript íƒ€ì… ì •ì˜
  - ì—°ê²°ì„±: 1.1.2 ì™„ë£Œ í›„ ë¦¬íŒ©í† ë§ìœ¼ë¡œ ì§„í–‰ (ì„ íƒ ì‚¬í•­)

### ğŸ“ ê°œì„ ëœ í”„ë¡¬í”„íŠ¸ ì½”ë“œ

```typescript
// frontend/src/app/api/chat/route.ts
// Line 100-112 ëŒ€ì²´

const systemPrompt = `
# ì—­í• 
ë‹¹ì‹ ì€ PRISM Writerì˜ AI ê¸€ì“°ê¸° ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

# í•µì‹¬ ì›ì¹™ (ë°˜ë“œì‹œ ì¤€ìˆ˜)
âš ï¸ ì¤‘ìš”: ì•„ë˜ ì°¸ê³  ìë£Œê°€ ì œê³µëœ ê²½ìš°, ë‹¹ì‹ ì˜ ì‚¬ì „ ì§€ì‹ë³´ë‹¤ ì°¸ê³  ìë£Œë¥¼ ìš°ì„ í•´ì•¼ í•©ë‹ˆë‹¤.
- ì°¸ê³  ìë£Œì˜ ìš©ì–´, êµ¬ì¡°, ë°©ë²•ë¡ ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì„¸ìš”
- ì¼ë°˜ì ì¸ ê¸€ì“°ê¸° ìƒì‹ì„ ë¨¼ì € ë§í•˜ì§€ ë§ˆì„¸ìš”
- ì°¸ê³  ìë£Œì— ì—†ëŠ” ë‚´ìš©ì„ ì¶”ê°€í•  ë•ŒëŠ” ëª…í™•íˆ êµ¬ë¶„í•˜ì„¸ìš”

# ì°¸ê³  ìë£Œ
${context ? context : "(ì°¸ê³  ìë£Œ ì—†ìŒ)"}

# ì‚¬ê³  ê³¼ì • (ë‹µë³€ ì „ ë‚´ë¶€ì ìœ¼ë¡œ ìˆ˜í–‰)
1. ë¶„ì„: ì°¸ê³  ìë£Œì˜ í•µì‹¬ í‚¤ì›Œë“œì™€ êµ¬ì¡°ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤
2. ì—°ê²°: ì‚¬ìš©ì ì§ˆë¬¸ì´ ì°¸ê³  ìë£Œì™€ ì–´ë–»ê²Œ ì—°ê²°ë˜ëŠ”ì§€ ì°¾ìŠµë‹ˆë‹¤
3. ì ìš©: ì°¸ê³  ìë£Œì˜ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©ì ì§ˆë¬¸ì— ì ìš©í•©ë‹ˆë‹¤
4. ë‹µë³€: ì°¸ê³  ìë£Œ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€ì„ êµ¬ì„±í•©ë‹ˆë‹¤

# ê¸ˆì§€ ì‚¬í•­
âŒ "ì°¸ê³  ìë£Œì— ê´€ë ¨ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤"ë¼ê³  ì¦‰ì‹œ íŒë‹¨í•˜ì§€ ë§ˆì„¸ìš”
âŒ ì¼ë°˜ì ì¸ ê¸€ì“°ê¸° ê°€ì´ë“œ(ê°œìš” ì§œê¸°, í‡´ê³ í•˜ê¸° ë“±)ë¥¼ ë¨¼ì € ì–¸ê¸‰í•˜ì§€ ë§ˆì„¸ìš”
âŒ ì°¸ê³  ìë£Œë¥¼ ë¬´ì‹œí•˜ê³  ì‚¬ì „ ì§€ì‹ë§Œìœ¼ë¡œ ë‹µë³€í•˜ì§€ ë§ˆì„¸ìš”

# ì¶œë ¥ í˜•ì‹
í•œêµ­ì–´ë¡œ ë‹µë³€í•˜ë˜, ì°¸ê³  ìë£Œì˜ í•µì‹¬ ê°œë…ì„ ì¸ìš©í•˜ë©° ë‹µë³€í•˜ì„¸ìš”.
`;
```

---

## 1.2 Chain of Thought ë¡œê¹… ì¶”ê°€ (ì„ íƒ)

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **1.2.1 CoT ë¡œê¹… í•¨ìˆ˜ ìƒì„±**
  - íŒŒì¼: `frontend/src/lib/rag/cotLogger.ts` (ì‹ ê·œ ìƒì„±)
  - ì‘ì—…: ëª¨ë¸ì´ ì‚¬ê³  ê³¼ì •ì„ ë¡œê¹…í•  ìˆ˜ ìˆëŠ” ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ìƒì„±
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] ì—ëŸ¬ ì²˜ë¦¬ ì¡´ì¬ (try-catch)
    - [ ] ëª…í™•í•œ í•¨ìˆ˜ëª… (`logChainOfThought`)
    - [ ] ê°œë°œ í™˜ê²½ì—ì„œë§Œ ë¡œê¹… (NODE_ENV ì²´í¬)
  - ì—°ê²°ì„±: 1.1.2 ì™„ë£Œ í›„ ì§„í–‰

```typescript
// frontend/src/lib/rag/cotLogger.ts (ì‹ ê·œ)

/**
 * Chain of Thought ë¡œê¹… (ê°œë°œ í™˜ê²½ ì „ìš©)
 */
export function logChainOfThought(
  query: string,
  context: string,
  step: "analyze" | "connect" | "apply" | "answer",
  details: string
): void {
  if (process.env.NODE_ENV !== "development") return;

  console.log(`[CoT-${step}] Query: "${query.substring(0, 30)}..."`);
  console.log(`[CoT-${step}] ${details}`);
}
```

---

## âœ… Phase 1 ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë¹Œë“œ ê²€ì¦

- [ ] TypeScript ë¹Œë“œ ì„±ê³µ: `npm run build` (0 errors)
- [ ] ESLint ì˜¤ë¥˜ ì—†ìŒ: `npm run lint`

### ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸

| #   | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤  | ì…ë ¥                | ì˜ˆìƒ ì¶œë ¥                | ê²°ê³¼ |
| --- | -------------- | ------------------- | ------------------------ | ---- |
| 1   | ì¶”ìƒì  ì§ˆë¬¸    | "ê¸€ì“°ê¸° ë°©ë²•"       | ì°¸ê³  ìë£Œ ê¸°ë°˜ ë‹µë³€      | â¬œ   |
| 2   | êµ¬ì²´ì  ì§ˆë¬¸    | "ê³µê°-ì •ë³´ êµ¬ì¡°ë€?" | ì°¸ê³  ìë£Œ ì¸ìš©           | â¬œ   |
| 3   | ê´€ë ¨ ì—†ëŠ” ì§ˆë¬¸ | "ë‚ ì”¨ ì–´ë•Œ?"        | ì¼ë°˜ ë‹µë³€ (í—ˆìš©)         | â¬œ   |
| 4   | íšŒí”¼ ë°©ì§€ í™•ì¸ | "ê¸€ êµ¬ì„±ë²•"         | "ë‚´ìš©ì´ ì—†ë‹¤" íšŒí”¼ ì•ˆ í•¨ | â¬œ   |

### ê¸°ì¡´ ê¸°ëŠ¥ ì •ìƒ ë™ì‘ í™•ì¸

- [ ] AI ì±„íŒ… ê¸°ë³¸ ëŒ€í™” ì •ìƒ
- [ ] ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ì •ìƒ
- [ ] ì„¸ì…˜ ì €ì¥/ë³µì› ì •ìƒ
- [ ] ì°¸ê³  ìë£Œ ê²€ìƒ‰ ì •ìƒ

### Phase 1 ì™„ë£Œ ì„œëª…

- [ ] ì‹œë‹ˆì–´ ê°œë°œì ë¦¬ë·° ì™„ë£Œ
- [ ] ë””ë ‰í„°ë‹˜ ìŠ¹ì¸

---

# Phase 2: Query Expansion ë° ê²€ìƒ‰ ê°œì„  (ë‹¨ê¸°)

## âš ï¸ ì˜í–¥ë°›ì„ ìˆ˜ ìˆëŠ” ê¸°ì¡´ ê¸°ëŠ¥

| ê¸°ëŠ¥           | íŒŒì¼               | ì˜í–¥ ê°€ëŠ¥ì„±                |
| -------------- | ------------------ | -------------------------- |
| RAG ê²€ìƒ‰       | `search.ts`        | ğŸ”´ High - ê²€ìƒ‰ ë¡œì§ ë³€ê²½   |
| ì±„íŒ… API       | `route.ts`         | ğŸŸ¡ Medium - ê²€ìƒ‰ í˜¸ì¶œ ë³€ê²½ |
| ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ | `ReferenceTab.tsx` | ğŸŸ¢ Low - ê²°ê³¼ í˜•ì‹ ë™ì¼    |

## ğŸ“Œ Phase 1 ì˜ì¡´ì„±

- âœ… Phase 1 ì™„ë£Œ í•„ìˆ˜ (í”„ë¡¬í”„íŠ¸ ê°œì„ ì´ ë¨¼ì € ì ìš©ë˜ì–´ì•¼ í•¨)

---

## 2.1 Query Expansion êµ¬í˜„

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **2.1.1 Query Expansion ëª¨ë“ˆ ìƒì„±**
  - íŒŒì¼: `frontend/src/lib/rag/queryExpansion.ts` (ì‹ ê·œ ìƒì„±)
  - ì‘ì—…: ì‚¬ìš©ì ì¿¼ë¦¬ë¥¼ í™•ì¥í•˜ëŠ” í•¨ìˆ˜ êµ¬í˜„
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] ëª…í™•í•œ í•¨ìˆ˜ëª… (`expandQuery`)
    - [ ] ì…ë ¥ ê²€ì¦ (ë¹ˆ ë¬¸ìì—´ ì²˜ë¦¬)
    - [ ] ì¤‘ë³µ ì œê±° ë¡œì§ í¬í•¨
    - [ ] JSDoc ì£¼ì„ í¬í•¨
  - ì—°ê²°ì„±: 2.1.2ì—ì„œ í˜¸ì¶œë¨

```typescript
// frontend/src/lib/rag/queryExpansion.ts (ì‹ ê·œ)

/**
 * Query Expansion - ì‚¬ìš©ì ì§ˆë¬¸ì„ í™•ì¥í•˜ì—¬ ê²€ìƒ‰ ì»¤ë²„ë¦¬ì§€ í–¥ìƒ
 *
 * @description
 * ì¶”ìƒì ì¸ ì§ˆë¬¸ì„ ë„ë©”ì¸ íŠ¹í™” ìš©ì–´ë¡œ í™•ì¥í•©ë‹ˆë‹¤.
 *
 * @param query - ì›ë³¸ ê²€ìƒ‰ ì¿¼ë¦¬
 * @returns í™•ì¥ëœ ì¿¼ë¦¬ ë°°ì—´
 *
 * @example
 * expandQuery("ê¸€ì“°ê¸° ë°©ë²•")
 * // => ["ê¸€ì“°ê¸° ë°©ë²•", "ì›ê³  ì‘ì„±", "ì½˜í…ì¸  êµ¬ì¡°", ...]
 */
export function expandQuery(query: string): string[] {
  // ì…ë ¥ ê²€ì¦
  if (!query || query.trim().length === 0) {
    return [];
  }

  const trimmedQuery = query.trim();
  const queries = [trimmedQuery];

  // ==========================================================================
  // [Domain Mapping] ë„ë©”ì¸ íŠ¹í™” ìš©ì–´ ë§¤í•‘
  // PRISM Writerì˜ ê¸€ì“°ê¸° ë„ë©”ì¸ì— íŠ¹í™”ëœ ë™ì˜ì–´ ì‚¬ì „
  // ==========================================================================
  const domainMap: Record<string, string[]> = {
    // ê¸€ì“°ê¸° ê´€ë ¨
    ê¸€ì“°ê¸°: ["ì›ê³  ì‘ì„±", "ì½˜í…ì¸  êµ¬ì„±", "ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±", "ê¸€ êµ¬ì„±"],
    ê¸€: ["ì›ê³ ", "ì½˜í…ì¸ ", "í…ìŠ¤íŠ¸", "ë¬¸ì„œ", "ìŠ¤í¬ë¦½íŠ¸"],
    ì“°ê¸°: ["ì‘ì„±", "êµ¬ì„±", "ê¸°íš", "ì œì‘"],
    ë°©ë²•: ["ê¸°ë²•", "êµ¬ì¡°", "í”„ë ˆì„ì›Œí¬", "ì ‘ê·¼ë²•", "ë°©ì‹"],

    // PRISM Writer íŠ¹í™”
    êµ¬ì¡°: ["í”„ë ˆì„ì›Œí¬", "ê³µê°-ì •ë³´", "ê¸°ìŠ¹ì „ê²°"],
    ìœ íŠœë¸Œ: ["ì˜ìƒ", "ì½˜í…ì¸ ", "ìŠ¤í¬ë¦½íŠ¸"],
    ì›ê³ : ["ìŠ¤í¬ë¦½íŠ¸", "ê¸€", "ì´ˆì•ˆ"],
  };

  // ==========================================================================
  // [Expansion Logic] í‚¤ì›Œë“œ ì¶”ì¶œ ë° í™•ì¥
  // ==========================================================================
  for (const [keyword, synonyms] of Object.entries(domainMap)) {
    if (trimmedQuery.includes(keyword)) {
      for (const synonym of synonyms) {
        const expanded = trimmedQuery.replace(keyword, synonym);
        if (!queries.includes(expanded)) {
          queries.push(expanded);
        }
      }
    }
  }

  // ìµœëŒ€ 5ê°œë¡œ ì œí•œ (ì„±ëŠ¥ ê³ ë ¤)
  return queries.slice(0, 5);
}
```

- [ ] **2.1.2 expandQuery í…ŒìŠ¤íŠ¸ ì‘ì„±**
  - íŒŒì¼: `frontend/src/lib/rag/__tests__/queryExpansion.test.ts` (ì‹ ê·œ)
  - ì‘ì—…: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] ë¹ˆ ì…ë ¥ í…ŒìŠ¤íŠ¸
    - [ ] í•œê¸€ ì…ë ¥ í…ŒìŠ¤íŠ¸
    - [ ] ì¤‘ë³µ ì œê±° í…ŒìŠ¤íŠ¸
  - ì—°ê²°ì„±: 2.1.1 ì™„ë£Œ í›„ ì§„í–‰

---

## 2.2 ê²€ìƒ‰ ë¡œì§ì— Query Expansion í†µí•©

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **2.2.1 route.tsì— Query Expansion ì ìš©**
  - íŒŒì¼: `frontend/src/app/api/chat/route.ts`
  - ìœ„ì¹˜: Line 74-95 (RAG ê²€ìƒ‰ ì„¹ì…˜)
  - ì‘ì—…: hybridSearch í˜¸ì¶œ ì „ì— ì¿¼ë¦¬ í™•ì¥
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] import ë¬¸ ì¶”ê°€
    - [ ] ì—ëŸ¬ ì²˜ë¦¬ (í™•ì¥ ì‹¤íŒ¨ ì‹œ ì›ë³¸ ì¿¼ë¦¬ ì‚¬ìš©)
    - [ ] ë¡œê¹… ì¶”ê°€ (ê°œë°œ í™˜ê²½)
  - ì—°ê²°ì„±: 2.1.1 ì™„ë£Œ í›„ ì§„í–‰

```typescript
// frontend/src/app/api/chat/route.ts
// Line 10 - import ì¶”ê°€
import { expandQuery } from "@/lib/rag/queryExpansion";

// Line 74-95 ëŒ€ì²´
// ==========================================================================
// [RAG Search with Query Expansion]
// ì‚¬ìš©ì ì¿¼ë¦¬ë¥¼ í™•ì¥í•˜ì—¬ ë” ë„“ì€ ë²”ìœ„ì˜ ë¬¸ì„œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
// ==========================================================================
let context = "";
try {
  // Step 1: Query Expansion
  const expandedQueries = expandQuery(query);
  console.log(`[Chat API] Expanded queries: ${expandedQueries.join(", ")}`);

  // Step 2: ê° ì¿¼ë¦¬ë¡œ ê²€ìƒ‰ ìˆ˜í–‰
  const allResults: SearchResult[] = [];
  for (const q of expandedQueries) {
    const results = await hybridSearch(q, {
      userId: userId || "demo-user",
      topK: 3, // ì¿¼ë¦¬ë‹¹ 3ê°œ (ì´ ìµœëŒ€ 15ê°œ)
      minScore: 0.3, // ì„ê³„ê°’ ì™„í™” (0.35 â†’ 0.30)
      vectorWeight: 0.6,
      keywordWeight: 0.4,
    });
    allResults.push(...results);
  }

  // Step 3: ì¤‘ë³µ ì œê±° ë° ì ìˆ˜ìˆœ ì •ë ¬
  const uniqueResults = deduplicateResults(allResults);
  const topResults = uniqueResults.slice(0, 5);

  if (topResults.length > 0) {
    context = topResults
      .map(
        (result) =>
          `[ì°¸ê³  ë¬¸ì„œ: ${result.metadata?.title || "Untitled"}]\n${
            result.content
          }`
      )
      .join("\n\n");
  } else {
    console.log("[Chat API] No relevant documents found.");
  }
} catch (error) {
  console.warn("RAG search failed:", error);
}
```

- [ ] **2.2.2 ì¤‘ë³µ ì œê±° ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ì¶”ê°€**
  - íŒŒì¼: `frontend/src/app/api/chat/route.ts` ë˜ëŠ” ë³„ë„ ìœ í‹¸ë¦¬í‹°
  - ì‘ì—…: chunkId ê¸°ì¤€ ì¤‘ë³µ ì œê±° í•¨ìˆ˜
  - ì—°ê²°ì„±: 2.2.1ì—ì„œ ì‚¬ìš©ë¨

```typescript
// route.ts ìƒë‹¨ì— ì¶”ê°€ (ë˜ëŠ” ë³„ë„ ìœ í‹¸ë¦¬í‹° íŒŒì¼)

function deduplicateResults(results: SearchResult[]): SearchResult[] {
  const seen = new Set<string>();
  return results
    .sort((a, b) => b.score - a.score) // ì ìˆ˜ ë†’ì€ ìˆœ
    .filter((result) => {
      if (seen.has(result.chunkId)) return false;
      seen.add(result.chunkId);
      return true;
    });
}
```

---

## 2.3 ë™ì  ì„ê³„ê°’ êµ¬í˜„

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **2.3.1 ë™ì  ì„ê³„ê°’ ëª¨ë“ˆ ìƒì„±**
  - íŒŒì¼: `frontend/src/lib/rag/dynamicThreshold.ts` (ì‹ ê·œ)
  - ì‘ì—…: ì¿¼ë¦¬ íŠ¹ì„±ì— ë”°ë¥¸ ì„ê³„ê°’ ê³„ì‚°
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] ì •ê·œí‘œí˜„ì‹ íŒ¨í„´ ëª…í™•
    - [ ] ê¸°ë³¸ê°’ ìƒìˆ˜ ì •ì˜
    - [ ] JSDoc ì£¼ì„
  - ì—°ê²°ì„±: 2.3.2ì—ì„œ ì‚¬ìš©ë¨

```typescript
// frontend/src/lib/rag/dynamicThreshold.ts (ì‹ ê·œ)

const BASE_THRESHOLD = 0.35;

// ì¶”ìƒì  ì§ˆë¬¸ íŒ¨í„´ (ì„ê³„ê°’ ë‚®ì¶¤)
const ABSTRACT_PATTERNS = [
  /ì–´ë–»ê²Œ.*í•´ì•¼/,
  /ë°©ë²•/,
  /~ë€\??$/,
  /ì•Œë ¤/,
  /ì„¤ëª…/,
  /ë¬´ì—‡/,
];

// êµ¬ì²´ì  ì§ˆë¬¸ íŒ¨í„´ (ì„ê³„ê°’ ìœ ì§€/ë†’ì„)
const SPECIFIC_PATTERNS = [
  /ê³µê°.*ì •ë³´/,
  /ìœ íŠœë¸Œ.*ì›ê³ /,
  /ì£¼ì›ê·œ/,
  /í”„ë ˆì„ì›Œí¬/,
  /PRISM/i,
];

/**
 * ì¿¼ë¦¬ íŠ¹ì„±ì— ë”°ë¥¸ ë™ì  ì„ê³„ê°’ ê³„ì‚°
 *
 * @param query - ê²€ìƒ‰ ì¿¼ë¦¬
 * @returns ì¡°ì •ëœ ì„ê³„ê°’ (0.0 ~ 1.0)
 */
export function calculateDynamicThreshold(query: string): number {
  // ì¶”ìƒì  ì§ˆë¬¸: ì„ê³„ê°’ ë‚®ì¶¤ (ë” ë§ì€ ë¬¸ì„œ í¬í•¨)
  if (ABSTRACT_PATTERNS.some((p) => p.test(query))) {
    return BASE_THRESHOLD * 0.7; // 0.245
  }

  // êµ¬ì²´ì  ì§ˆë¬¸: ì„ê³„ê°’ ë†’ì„ (ì •í™•ë„ ìš°ì„ )
  if (SPECIFIC_PATTERNS.some((p) => p.test(query))) {
    return BASE_THRESHOLD * 1.2; // 0.42
  }

  return BASE_THRESHOLD;
}
```

- [ ] **2.3.2 ê²€ìƒ‰ ë¡œì§ì— ë™ì  ì„ê³„ê°’ ì ìš©**
  - íŒŒì¼: `frontend/src/app/api/chat/route.ts`
  - ì‘ì—…: hybridSearch í˜¸ì¶œ ì‹œ ë™ì  ì„ê³„ê°’ ì‚¬ìš©
  - ì—°ê²°ì„±: 2.3.1, 2.2.1 ì™„ë£Œ í›„ ì§„í–‰

---

## âœ… Phase 2 ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë¹Œë“œ ê²€ì¦

- [ ] TypeScript ë¹Œë“œ ì„±ê³µ: `npm run build` (0 errors)
- [ ] ESLint ì˜¤ë¥˜ ì—†ìŒ
- [ ] ì‹ ê·œ íŒŒì¼ import ì˜¤ë¥˜ ì—†ìŒ

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

- [ ] `expandQuery` í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] `calculateDynamicThreshold` í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] `deduplicateResults` í…ŒìŠ¤íŠ¸ í†µê³¼

### ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸

| #   | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤  | ì…ë ¥               | í™•ì¸ ì‚¬í•­                 | ê²°ê³¼ |
| --- | -------------- | ------------------ | ------------------------- | ---- |
| 1   | ì¿¼ë¦¬ í™•ì¥ í™•ì¸ | "ê¸€ì“°ê¸° ë°©ë²•"      | ì½˜ì†”ì— í™•ì¥ëœ ì¿¼ë¦¬ ë¡œê¹…ë¨ | â¬œ   |
| 2   | ì¤‘ë³µ ì œê±° í™•ì¸ | ë™ì¼ ë¬¸ì„œ 2ë²ˆ ê²€ìƒ‰ | ê²°ê³¼ì— ì¤‘ë³µ ì—†ìŒ          | â¬œ   |
| 3   | ë™ì  ì„ê³„ê°’    | ì¶”ìƒì  ì§ˆë¬¸        | ë” ë§ì€ ë¬¸ì„œ ê²€ìƒ‰ë¨       | â¬œ   |
| 4   | ì„±ëŠ¥ í™•ì¸      | ì¼ë°˜ ì§ˆë¬¸          | ì‘ë‹µ ì‹œê°„ 3ì´ˆ ì´ë‚´        | â¬œ   |

### ê¸°ì¡´ ê¸°ëŠ¥ ì •ìƒ ë™ì‘ í™•ì¸

- [ ] AI ì±„íŒ… ê¸°ë³¸ ëŒ€í™” ì •ìƒ
- [ ] Phase 1 ê°œì„  íš¨ê³¼ ìœ ì§€
- [ ] ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ì •ìƒ
- [ ] ì°¸ê³  ìë£Œ íƒ­ ì •ìƒ

### Phase 2 ì™„ë£Œ ì„œëª…

- [ ] ì‹œë‹ˆì–´ ê°œë°œì ë¦¬ë·° ì™„ë£Œ
- [ ] ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] ë””ë ‰í„°ë‹˜ ìŠ¹ì¸

---

# Phase 3: Bad Case ìˆ˜ì§‘ ë° í™˜ê° íƒì§€ (ì¤‘ê¸°)

## âš ï¸ ì˜í–¥ë°›ì„ ìˆ˜ ìˆëŠ” ê¸°ì¡´ ê¸°ëŠ¥

| ê¸°ëŠ¥       | íŒŒì¼                | ì˜í–¥ ê°€ëŠ¥ì„±                  |
| ---------- | ------------------- | ---------------------------- |
| í”¼ë“œë°± API | (ì‹ ê·œ)              | ğŸŸ¢ ì‹ ê·œ ì¶”ê°€                 |
| ì±„íŒ… UI    | `ChatInterface.tsx` | ğŸŸ¡ Medium - í”¼ë“œë°± ë²„íŠ¼ ì¶”ê°€ |
| DB ìŠ¤í‚¤ë§ˆ  | (ë§ˆì´ê·¸ë ˆì´ì…˜)      | ğŸŸ¡ Medium - ì‹ ê·œ í…Œì´ë¸”      |

## ğŸ“Œ Phase 2 ì˜ì¡´ì„±

- âœ… Phase 2 ì™„ë£Œ ê¶Œì¥ (ê²€ìƒ‰ ê°œì„ ì´ ë¨¼ì € ì ìš©ëœ ìƒíƒœì—ì„œ Bad Case ìˆ˜ì§‘ì´ ì˜ë¯¸ ìˆìŒ)

---

## 3.1 í™˜ê° íƒì§€ ì‹œìŠ¤í…œ

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.1.1 í™˜ê° íƒì§€ ëª¨ë“ˆ ìƒì„±**
  - íŒŒì¼: `frontend/src/lib/rag/hallucinationDetector.ts` (ì‹ ê·œ)
  - ì‘ì—…: íšŒí”¼í˜• í™˜ê° íƒì§€ ë¡œì§ êµ¬í˜„
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] ëª…í™•í•œ í•¨ìˆ˜ëª…
    - [ ] íƒì§€ ê·œì¹™ í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°
    - [ ] ë¡œê¹… í¬í•¨

```typescript
// frontend/src/lib/rag/hallucinationDetector.ts (ì‹ ê·œ)

export interface HallucinationCheckResult {
  isHallucination: boolean;
  type: "evasion" | "none";
  confidence: number;
  matchedPattern: string | null;
}

// íšŒí”¼ì„± ë¬¸êµ¬ íŒ¨í„´
const EVASION_PATTERNS = [
  { pattern: /ì°¸ê³ \s*ìë£Œì—\s*(ê´€ë ¨)?\s*ë‚´ìš©ì´\s*ì—†/, confidence: 0.9 },
  { pattern: /ì œê³µëœ\s*ìë£Œì—ëŠ”.*ì—†/, confidence: 0.85 },
  { pattern: /ê´€ë ¨\s*ë¬¸ì„œê°€\s*ì—†/, confidence: 0.8 },
  { pattern: /ìë£Œë¥¼\s*ì°¾ì„\s*ìˆ˜\s*ì—†/, confidence: 0.8 },
  { pattern: /ê´€ë ¨\s*ë‚´ìš©ì´\s*ì—†/, confidence: 0.75 },
];

/**
 * íšŒí”¼í˜• í™˜ê° íƒì§€
 *
 * @param hasRetrievedDocs - ê²€ìƒ‰ëœ ë¬¸ì„œ ì¡´ì¬ ì—¬ë¶€
 * @param modelResponse - ëª¨ë¸ ì‘ë‹µ í…ìŠ¤íŠ¸
 * @returns í™˜ê° íƒì§€ ê²°ê³¼
 */
export function detectEvasionHallucination(
  hasRetrievedDocs: boolean,
  modelResponse: string
): HallucinationCheckResult {
  // ë¬¸ì„œê°€ ì—†ìœ¼ë©´ í™˜ê°ì´ ì•„ë‹˜
  if (!hasRetrievedDocs) {
    return {
      isHallucination: false,
      type: "none",
      confidence: 1.0,
      matchedPattern: null,
    };
  }

  // íšŒí”¼ì„± ë¬¸êµ¬ ê²€ì‚¬
  for (const { pattern, confidence } of EVASION_PATTERNS) {
    if (pattern.test(modelResponse)) {
      return {
        isHallucination: true,
        type: "evasion",
        confidence,
        matchedPattern: pattern.source,
      };
    }
  }

  return {
    isHallucination: false,
    type: "none",
    confidence: 1.0,
    matchedPattern: null,
  };
}
```

- [ ] **3.1.2 ì‘ë‹µ í›„ í™˜ê° ì²´í¬ í†µí•©**
  - íŒŒì¼: `frontend/src/app/api/chat/route.ts`
  - ìœ„ì¹˜: ì‘ë‹µ ì™„ë£Œ í›„ (Line 140-165 ê·¼ì²˜)
  - ì‘ì—…: í™˜ê° íƒì§€ ë° ë¡œê¹…
  - ì—°ê²°ì„±: 3.1.1 ì™„ë£Œ í›„ ì§„í–‰

---

## 3.2 Bad Case ìˆ˜ì§‘ UI

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.2.1 í”¼ë“œë°± ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸ ìƒì„±**
  - íŒŒì¼: `frontend/src/components/Chat/FeedbackButtons.tsx` (ì‹ ê·œ)
  - ì‘ì—…: ğŸ‘/ğŸ‘ í”¼ë“œë°± ë²„íŠ¼ UI
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] ì ‘ê·¼ì„±: `aria-label` í¬í•¨
    - [ ] ë°˜ì‘í˜• ë””ìì¸
    - [ ] ë‹¤í¬ ëª¨ë“œ ì§€ì›
  - ì—°ê²°ì„±: 3.2.2ì—ì„œ ì‚¬ìš©ë¨

```tsx
// frontend/src/components/Chat/FeedbackButtons.tsx (ì‹ ê·œ)

interface FeedbackButtonsProps {
  messageId: string;
  onFeedback: (messageId: string, isPositive: boolean) => void;
}

export function FeedbackButtons({
  messageId,
  onFeedback,
}: FeedbackButtonsProps) {
  return (
    <div className="flex gap-2 mt-2">
      <button
        onClick={() => onFeedback(messageId, true)}
        className="p-1 hover:bg-green-100 dark:hover:bg-green-900 rounded"
        aria-label="ì¢‹ì€ ë‹µë³€"
      >
        ğŸ‘
      </button>
      <button
        onClick={() => onFeedback(messageId, false)}
        className="p-1 hover:bg-red-100 dark:hover:bg-red-900 rounded"
        aria-label="ê°œì„  í•„ìš”í•œ ë‹µë³€"
      >
        ğŸ‘
      </button>
    </div>
  );
}
```

- [ ] **3.2.2 ì±„íŒ… UIì— í”¼ë“œë°± ë²„íŠ¼ í†µí•©**

  - íŒŒì¼: `frontend/src/components/Assistant/ChatInterface.tsx` ë˜ëŠ” í•´ë‹¹ íŒŒì¼
  - ì‘ì—…: AI ì‘ë‹µ ë©”ì‹œì§€ì— í”¼ë“œë°± ë²„íŠ¼ ì¶”ê°€
  - í’ˆì§ˆ ê¸°ì¤€:
    - [ ] ì»´í¬ë„ŒíŠ¸ import
    - [ ] ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—°ê²°
  - ì—°ê²°ì„±: 3.2.1 â†’ 3.2.2 ìˆœì„œ

- [ ] **3.2.3 í”¼ë“œë°± API ì—”ë“œí¬ì¸íŠ¸ ìƒì„±**
  - íŒŒì¼: `frontend/src/app/api/feedback/hallucination/route.ts` (ì‹ ê·œ)
  - ì‘ì—…: í”¼ë“œë°± ì €ì¥ API
  - ì—°ê²°ì„±: 3.2.2ì—ì„œ í˜¸ì¶œë¨

---

## 3.3 DB ìŠ¤í‚¤ë§ˆ (ë§ˆì´ê·¸ë ˆì´ì…˜)

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.3.1 hallucination_feedback í…Œì´ë¸” ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì„±**
  - íŒŒì¼: `backend/migrations/038_hallucination_feedback.sql` (ì‹ ê·œ)
  - ì‘ì—…: í”¼ë“œë°± ì €ì¥ìš© í…Œì´ë¸” ìƒì„±

```sql
-- backend/migrations/038_hallucination_feedback.sql

CREATE TABLE IF NOT EXISTS hallucination_feedback (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
    session_id UUID REFERENCES chat_sessions(id) ON DELETE CASCADE,
    message_id UUID,

    -- ì…ë ¥ ë°ì´í„°
    user_query TEXT NOT NULL,
    retrieved_docs JSONB,
    model_response TEXT NOT NULL,

    -- í”¼ë“œë°±
    is_positive BOOLEAN NOT NULL,
    feedback_type TEXT CHECK (feedback_type IN ('hallucination', 'quality', 'other')),
    user_comment TEXT,

    -- ìë™ íƒì§€ ê²°ê³¼
    auto_detected_hallucination BOOLEAN DEFAULT FALSE,
    detection_confidence DECIMAL(3,2),
    matched_pattern TEXT,

    -- ë©”íƒ€ë°ì´í„°
    model_id TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- RLS
ALTER TABLE hallucination_feedback ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can insert their own feedback"
    ON hallucination_feedback FOR INSERT
    WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can view their own feedback"
    ON hallucination_feedback FOR SELECT
    USING (auth.uid() = user_id);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_hallucination_feedback_auto
    ON hallucination_feedback(auto_detected_hallucination);
```

- [ ] **3.3.2 Supabaseì— ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©**
  - ì‘ì—…: Supabase SQL Editorì—ì„œ ì‹¤í–‰
  - ì—°ê²°ì„±: 3.3.1 ì™„ë£Œ í›„ ì§„í–‰

---

## âœ… Phase 3 ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë¹Œë“œ ê²€ì¦

- [ ] TypeScript ë¹Œë“œ ì„±ê³µ
- [ ] ESLint ì˜¤ë¥˜ ì—†ìŒ
- [ ] ë§ˆì´ê·¸ë ˆì´ì…˜ SQL ë¬¸ë²• ì˜¤ë¥˜ ì—†ìŒ

### UI í…ŒìŠ¤íŠ¸

| #   | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤      | í™•ì¸ ì‚¬í•­                   | ê²°ê³¼ |
| --- | ------------------ | --------------------------- | ---- |
| 1   | í”¼ë“œë°± ë²„íŠ¼ í‘œì‹œ   | AI ì‘ë‹µì— ğŸ‘/ğŸ‘ ë²„íŠ¼ ë³´ì„   | â¬œ   |
| 2   | í”¼ë“œë°± ë²„íŠ¼ ì ‘ê·¼ì„± | ìŠ¤í¬ë¦° ë¦¬ë” aria-label ì½í˜ | â¬œ   |
| 3   | í”¼ë“œë°± ì €ì¥        | í´ë¦­ ì‹œ DBì— ì €ì¥ë¨         | â¬œ   |
| 4   | ë‹¤í¬ ëª¨ë“œ          | ë²„íŠ¼ ìƒ‰ìƒ ì •ìƒ              | â¬œ   |

### DB í…ŒìŠ¤íŠ¸

- [ ] `hallucination_feedback` í…Œì´ë¸” ì¡´ì¬
- [ ] RLS ì •ì±… ì •ìƒ ì‘ë™
- [ ] INSERT/SELECT ì¿¼ë¦¬ ì„±ê³µ

### Phase 3 ì™„ë£Œ ì„œëª…

- [ ] ì‹œë‹ˆì–´ ê°œë°œì ë¦¬ë·° ì™„ë£Œ
- [ ] UX/UI ì „ë¬¸ê°€ ë¦¬ë·° ì™„ë£Œ
- [ ] ë””ë ‰í„°ë‹˜ ìŠ¹ì¸

---

# Phase 4: RAFT íŒŒì¸íŠœë‹ ì¤€ë¹„ (ì¥ê¸°)

## âš ï¸ ì£¼ì˜ì‚¬í•­

> âš ï¸ **Phase 4ëŠ” ì¥ê¸° í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.**
>
> ì‹¤ì œ íŒŒì¸íŠœë‹ì€ **ë³„ë„ì˜ ML ì¸í”„ë¼ì™€ ë¦¬ì†ŒìŠ¤**ê°€ í•„ìš”í•©ë‹ˆë‹¤.
> ì´ Phaseì—ì„œëŠ” **ë°ì´í„° ì¤€ë¹„ ë° ê³„íš ìˆ˜ë¦½**ë§Œ ì§„í–‰í•©ë‹ˆë‹¤.

## ğŸ“Œ Phase 3 ì˜ì¡´ì„±

- âœ… Phase 3 ì™„ë£Œ í•„ìˆ˜ (Bad Case ë°ì´í„°ê°€ ì¶•ì ë˜ì–´ì•¼ í•¨)

---

## 4.1 SFT ë°ì´í„°ì…‹ í¬ë§· ì •ì˜

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **4.1.1 ë°ì´í„°ì…‹ ìŠ¤í‚¤ë§ˆ ì„¤ê³„**
  - íŒŒì¼: `docs/raft-dataset-schema.md` (ë¬¸ì„œ)
  - ì‘ì—…: í•™ìŠµìš© ë°ì´í„° í¬ë§· ì •ì˜
  - ì—°ê²°ì„±: 4.1.2 ë°ì´í„° ìˆ˜ì§‘ì˜ ê¸°ì¤€

```json
{
  "id": "001",
  "instruction": "ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ì°¸ê³  ìë£Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”.",
  "input": {
    "question": "ê¸€ì„ ì“¸ ë•Œ ì–´ë–»ê²Œ ì¨ì•¼ í•˜ë‚˜ìš”?",
    "context": [
      {
        "title": "ìœ íŠœë¸Œ ì›ê³  ì‘ì„± ê°€ì´ë“œ",
        "content": "ê³µê°-ì •ë³´ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ì—¬..."
      }
    ]
  },
  "chosen_output": "ê¸€ì„ ì“¸ ë•ŒëŠ” 'ê³µê°-ì •ë³´' êµ¬ì¡°ë¥¼ í™œìš©í•˜ë©´ íš¨ê³¼ì ì…ë‹ˆë‹¤...",
  "rejected_output": "ê¸€ì“°ê¸°ì˜ ê¸°ë³¸ì€ ê°œìš”ë¥¼ ë¨¼ì € ì‘ì„±í•˜ê³ ...",
  "rejection_reason": "ì°¸ê³  ìë£Œê°€ ìˆìŒì—ë„ ì¼ë°˜ë¡ ìœ¼ë¡œ ë‹µë³€í•¨"
}
```

- [ ] **4.1.2 ë°ì´í„° ìˆ˜ì§‘ ìë™í™” ìŠ¤í¬ë¦½íŠ¸**

  - íŒŒì¼: `scripts/collect-sft-data.ts` (ì‹ ê·œ)
  - ì‘ì—…: `hallucination_feedback` í…Œì´ë¸”ì—ì„œ Bad Case ì¶”ì¶œ
  - ì—°ê²°ì„±: 4.1.1 ìŠ¤í‚¤ë§ˆ ê¸°ì¤€ìœ¼ë¡œ ì¶”ì¶œ

- [ ] **4.1.3 500ê°œ ì´ìƒ Bad Case ìˆ˜ì§‘**
  - ì‘ì—…: ì‹¤ì œ ì‚¬ìš©ì í”¼ë“œë°± + ì¸ìœ„ì  ì¼€ì´ìŠ¤ ìˆ˜ì§‘
  - ì™„ë£Œ ê¸°ì¤€: 500ê°œ ì´ìƒ ë°ì´í„°ì…‹ í™•ë³´

---

## âœ… Phase 4 ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°ì´í„° í’ˆì§ˆ

- [ ] 500ê°œ ì´ìƒ ë°ì´í„°ì…‹ í™•ë³´
- [ ] JSON ìŠ¤í‚¤ë§ˆ ì¼ê´€ì„± ê²€ì¦
- [ ] ì¤‘ë³µ ë°ì´í„° ì œê±°

### ë¬¸ì„œí™”

- [ ] ë°ì´í„°ì…‹ ìŠ¤í‚¤ë§ˆ ë¬¸ì„œí™”
- [ ] ìˆ˜ì§‘ í”„ë¡œì„¸ìŠ¤ ë¬¸ì„œí™”
- [ ] íŒŒì¸íŠœë‹ ê³„íš ìˆ˜ë¦½

### Phase 4 ì™„ë£Œ ì„œëª…

- [ ] ì‹œë‹ˆì–´ ê°œë°œì ë¦¬ë·° ì™„ë£Œ
- [ ] ë””ë ‰í„°ë‹˜ ìŠ¹ì¸
- [ ] íŒŒì¸íŠœë‹ ì°©ìˆ˜ ê²°ì •

---

# ğŸ“Š ì „ì²´ ì§„í–‰ í˜„í™©

| Phase       | ìƒíƒœ    | ì™„ë£Œìœ¨ | ë‹´ë‹¹                |
| ----------- | ------- | ------ | ------------------- |
| **Phase 1** | â³ ëŒ€ê¸° | 0%     | í”„ë¡¬í”„íŠ¸ ì „ë¬¸ê°€     |
| **Phase 2** | â³ ëŒ€ê¸° | 0%     | RAG ê²€ìƒ‰ ì „ë¬¸ê°€     |
| **Phase 3** | â³ ëŒ€ê¸° | 0%     | ì‹œë‹ˆì–´ + UX ì „ë¬¸ê°€  |
| **Phase 4** | â³ ëŒ€ê¸° | 0%     | ë°ì´í„° ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸ |

---

## ğŸ“ ë³€ê²½ ì´ë ¥

| ë‚ ì§œ       | ë²„ì „ | ë³€ê²½ ë‚´ìš© | ì‘ì„±ì        |
| ---------- | ---- | --------- | ------------- |
| 2025-12-27 | v1.0 | ì´ˆì•ˆ ì‘ì„± | ì‹œë‹ˆì–´ ê°œë°œì |

---

> **ë‹¤ìŒ ë‹¨ê³„**: ë””ë ‰í„°ë‹˜ ê²€í†  í›„ Phase 1 ì°©ìˆ˜
