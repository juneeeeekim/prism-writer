# Phase 11: JeDebug Review - Document Save & List Checklist

**ê²€í†  ëŒ€ìƒ**: `2512280320_Document_Save_List_Checklist.md`  
**ê²€í†  ì¼ì‹œ**: 2025-12-28 03:24 KST  
**ê²€í† ì**: JeDebug (Senior Lead Developer)

---

## 1) ğŸ”§ ë¡œì§ ë° êµ¬í˜„ ë³´ì™„ (Logic Fixes)

### Critical Issues

- [ ] **(Critical) P2-01 ëˆ„ë½ëœ ë¡œì§: Supabase í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ ì„¸ì…˜ íšë“**

  - [ ] ì›ì¸: API Routeì—ì„œ `createServerClient` ë˜ëŠ” `createRouteHandlerClient` ì‚¬ìš©ë²• ë¯¸ëª…ì‹œ. í˜„ì¬ í”„ë¡œì íŠ¸ì˜ Supabase í´ë¼ì´ì–¸íŠ¸ íŒ¨í„´ í™•ì¸ í•„ìš”.
  - [ ] **ìˆ˜ì • ì œì•ˆ**: P2-01 `Detail`ì— ë‹¤ìŒ ì¶”ê°€:

    ```typescript
    import { createRouteHandlerClient } from "@supabase/auth-helpers-nextjs";
    import { cookies } from "next/headers";

    const supabase = createRouteHandlerClient({ cookies });
    const {
      data: { user },
    } = await supabase.auth.getUser();
    if (!user)
      return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
    ```

  - [ ] íŒŒì¼/ìœ„ì¹˜: P2-01, P2-02, P2-03, P2-04 ëª¨ë“  APIì— ë™ì¼ ì ìš©

- [ ] **(Critical) P3-01 ëˆ„ë½ëœ ë¡œì§: Document íƒ€ì… ì •ì˜**

  - [ ] ì›ì¸: `useState<Document[]>` ì‚¬ìš©í•˜ì§€ë§Œ `Document` ì¸í„°í˜ì´ìŠ¤ ì •ì˜ ì—†ìŒ
  - [ ] **ìˆ˜ì • ì œì•ˆ**: Phase 3 ì‹œì‘ ì „ ìƒˆ í•­ëª© ì¶”ê°€:
    ```
    - [ ] **P3-00**: Document íƒ€ì… ì •ì˜
      - `Target`: `frontend/src/types/document.ts` (ì‹ ê·œ)
      - `Detail`:
        interface UserDocument {
          id: string
          title: string
          content: string
          created_at: string
          updated_at: string
        }
    ```
  - [ ] íŒŒì¼/ìœ„ì¹˜: Phase 3 ìµœìƒë‹¨ì— P3-00 ì¶”ê°€

- [ ] **(Critical) P3-03 í›… ì‚¬ìš© íŒ¨í„´ ì˜¤ë¥˜**
  - [ ] ì›ì¸: `useDocuments().saveDocument()` í˜•íƒœëŠ” ë§¤ ë Œë”ë§ë§ˆë‹¤ ìƒˆ í›… ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (React Rules of Hooks ìœ„ë°˜ ê°€ëŠ¥ì„±)
  - [ ] **ìˆ˜ì • ì œì•ˆ**: P3-03 ë³€ê²½:
    ```
    - ë³€ê²½: ì»´í¬ë„ŒíŠ¸ ìµœìƒìœ„ì—ì„œ `const { saveDocument } = useDocuments()` ì„ ì–¸
    - handleSaveì—ì„œ `saveDocument({ title, content, id: documentId })` í˜¸ì¶œ
    ```
  - [ ] íŒŒì¼/ìœ„ì¹˜: P3-03 `Detail` ìˆ˜ì •

### Major Issues

- [ ] **(Major) P4-03 URL Query íŒŒì‹± ë°©ì‹ ë¯¸ëª…ì‹œ**

  - [ ] ì›ì¸: Next.js 13+ App Routerì—ì„œ `searchParams` ì ‘ê·¼ ë°©ì‹ ëª…ì‹œ í•„ìš”
  - [ ] **ìˆ˜ì • ì œì•ˆ**: P4-03 `Detail`ì— ì¶”ê°€:
    ```typescript
    // Next.js App Router ë°©ì‹
    export default function EditorPage({
      searchParams,
    }: {
      searchParams: { id?: string };
    }) {
      const documentId = searchParams.id;
      // ...
    }
    ```
  - [ ] íŒŒì¼/ìœ„ì¹˜: P4-03 `Detail`

- [ ] **(Major) P3-03 Toast ì»´í¬ë„ŒíŠ¸ ì˜ì¡´ì„±**

  - [ ] ì›ì¸: "Toast ì•Œë¦¼" ì–¸ê¸‰í•˜ì§€ë§Œ í”„ë¡œì íŠ¸ì— Toast ì»´í¬ë„ŒíŠ¸ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ ì•ˆë¨
  - [ ] **ìˆ˜ì • ì œì•ˆ**: P3-03 ì•ì— í™•ì¸ ë‹¨ê³„ ì¶”ê°€:
    ```
    - [ ] **P3-02-A**: Toast ì»´í¬ë„ŒíŠ¸ í™•ì¸/ìƒì„±
      - ê¸°ì¡´ Toast ìˆìœ¼ë©´ import ê²½ë¡œ í™•ì¸
      - ì—†ìœ¼ë©´ ê°„ë‹¨í•œ Toast ë˜ëŠ” browser alert() ì‚¬ìš©
    ```
  - [ ] íŒŒì¼/ìœ„ì¹˜: P3-03 ì•ì— ì‚½ì…

- [ ] **(Major) P5-01 ìë™ ì €ì¥ ì‹œ documentId ì—†ëŠ” ê²½ìš°**
  - [ ] ì›ì¸: ìƒˆ ë¬¸ì„œ(documentId ì—†ìŒ)ì—ì„œ ìë™ ì €ì¥ ì‹œ INSERTë˜ê³ , ì´í›„ ì €ì¥ ì‹œ ë˜ INSERTë˜ì–´ ì¤‘ë³µ ë¬¸ì„œ ìƒì„± ê°€ëŠ¥
  - [ ] **ìˆ˜ì • ì œì•ˆ**: P5-01 `Detail`ì— ì¶”ê°€:
    ```
    - ì²« ì €ì¥ í›„ ë°˜í™˜ëœ idë¥¼ documentIdì— ì„¸íŒ…
    - ì´í›„ ì €ì¥ì€ í•´ë‹¹ idë¡œ UPDATE
    ```
  - [ ] íŒŒì¼/ìœ„ì¹˜: P5-01 `Detail`

---

## 2) ğŸš¨ ë¦¬ìŠ¤í¬ ë° ì•ˆì „ì¥ì¹˜ (Risk Guardrails)

### High Risk

- [ ] **(High) ê¸°ì¡´ localStorage ë°ì´í„° ìœ ì‹¤ ìœ„í—˜**

  - [ ] ìœ„í—˜ ìš”ì†Œ: ê¸°ì¡´ ì‚¬ìš©ìê°€ localStorageì— ì €ì¥í•œ ê¸€ì´ ìˆëŠ” ìƒíƒœì—ì„œ DB ì €ì¥ ì‹œìŠ¤í…œìœ¼ë¡œ ì „í™˜ ì‹œ, ê¸°ì¡´ ê¸€ ì†ì‹¤
  - [ ] **ë°©ì–´ ì½”ë“œ ì¶”ê°€ ì œì•ˆ**: Phase 5ì— ë§ˆì´ê·¸ë ˆì´ì…˜ ë¡œì§ ì¶”ê°€:
    ```
    - [ ] **P5-00**: localStorage â†’ DB ë§ˆì´ê·¸ë ˆì´ì…˜
      - ìµœì´ˆ ë¡œê·¸ì¸ ì‹œ localStorageì— contentê°€ ìˆìœ¼ë©´
      - "ê¸°ì¡´ ì‘ì„± ì¤‘ì¸ ê¸€ì„ ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?" ëª¨ë‹¬ í‘œì‹œ
      - í™•ì¸ ì‹œ DBì— ì €ì¥ í›„ localStorage í´ë¦¬ì–´
    ```
  - [ ] íŒŒì¼/ìœ„ì¹˜: Phase 5 ìµœìƒë‹¨ì— ì¶”ê°€

- [ ] **(High) ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì ì—ë””í„° ì ‘ê·¼**
  - [ ] ìœ„í—˜ ìš”ì†Œ: ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ìê°€ `/editor`ì—ì„œ ì €ì¥ ë²„íŠ¼ í´ë¦­ ì‹œ 401 ì—ëŸ¬ë§Œ ë°œìƒí•˜ê³  UX ì—†ìŒ
  - [ ] **ë°©ì–´ ì½”ë“œ ì¶”ê°€ ì œì•ˆ**: P3-03ì— ì¶”ê°€:
    ```
    - useAuth()ë¡œ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
    - ë¹„ë¡œê·¸ì¸ ì‹œ "ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤" ì•ˆë‚´ í›„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    - ë˜ëŠ” ì €ì¥ ë²„íŠ¼ ìì²´ë¥¼ ìˆ¨ê¹€
    ```
  - [ ] íŒŒì¼/ìœ„ì¹˜: P3-03 `Quality` ì„¹ì…˜

### Mid Risk

- [ ] **(Mid) ëŒ€ìš©ëŸ‰ ë¬¸ì„œ ì„±ëŠ¥ ì´ìŠˆ**

  - [ ] ìœ„í—˜ ìš”ì†Œ: contentê°€ ë§¤ìš° ê¸´ ê²½ìš°(ìˆ˜ë§Œ ì) ëª©ë¡ ì¡°íšŒ ì‹œ ë¶ˆí•„ìš”í•œ ì „ì²´ content ë¡œë“œ
  - [ ] **ë°©ì–´ ë¡œì§ ì œì•ˆ**: P2-02 `Detail` ìˆ˜ì •:
    ```sql
    SELECT id, title, LEFT(content, 100) as preview, updated_at
    FROM user_documents
    WHERE user_id = $1
    ```
  - [ ] íŒŒì¼/ìœ„ì¹˜: P2-02

- [ ] **(Mid) user_id ì¸ë±ìŠ¤ ëˆ„ë½**
  - [ ] ìœ„í—˜ ìš”ì†Œ: ë¬¸ì„œê°€ ë§ì•„ì§€ë©´ user_id ê¸°ë°˜ ì¡°íšŒ ì„±ëŠ¥ ì €í•˜
  - [ ] **ë°©ì–´ ë¡œì§ ì œì•ˆ**: P1-01ì— ì¸ë±ìŠ¤ ì¶”ê°€:
    ```sql
    CREATE INDEX idx_user_documents_user_id ON public.user_documents(user_id);
    CREATE INDEX idx_user_documents_updated_at ON public.user_documents(updated_at DESC);
    ```
  - [ ] íŒŒì¼/ìœ„ì¹˜: P1-01 `Detail` ë§ˆì§€ë§‰ì— ì¶”ê°€

---

## 3) ğŸ§ª ê²€ì¦ ê¸°ì¤€ êµ¬ì²´í™” (Test Criteria)

### Happy Path í…ŒìŠ¤íŠ¸

- [ ] **HP-01**: ìƒˆ ê¸€ ì‘ì„± â†’ ì €ì¥ â†’ ëª©ë¡ì—ì„œ í™•ì¸
  - ì…ë ¥: ì œëª© "í…ŒìŠ¤íŠ¸ ë¬¸ì„œ", ë‚´ìš© "ì•ˆë…•í•˜ì„¸ìš”"
  - ê¸°ëŒ€ ê²°ê³¼: DBì— row ìƒì„±, `/documents`ì—ì„œ ì¹´ë“œ í‘œì‹œ
- [ ] **HP-02**: ê¸°ì¡´ ê¸€ ìˆ˜ì • â†’ ì €ì¥ â†’ ë‚´ìš© ìœ ì§€

  - ì…ë ¥: ê¸°ì¡´ ë¬¸ì„œ ë¡œë“œ â†’ ì œëª© ë³€ê²½ â†’ ì €ì¥
  - ê¸°ëŒ€ ê²°ê³¼: ë™ì¼ id, updated_at ê°±ì‹ , ìƒˆ row ì—†ìŒ

- [ ] **HP-03**: ê¸€ ì‚­ì œ â†’ ëª©ë¡ì—ì„œ ì œê±°
  - ì…ë ¥: ì‚­ì œ ë²„íŠ¼ í´ë¦­ â†’ í™•ì¸
  - ê¸°ëŒ€ ê²°ê³¼: DB row ì‚­ì œ, ëª©ë¡ ì¦‰ì‹œ ê°±ì‹ 

### Edge Case í…ŒìŠ¤íŠ¸

- [ ] **EC-01**: ë¹„ë¡œê·¸ì¸ ìƒíƒœì—ì„œ ì €ì¥ ì‹œë„
  - ê¸°ëŒ€ ê²°ê³¼: 401 ì‘ë‹µ + ì‚¬ìš©ìì—ê²Œ ë¡œê·¸ì¸ ìœ ë„ ë©”ì‹œì§€
- [ ] **EC-02**: ë„¤íŠ¸ì›Œí¬ ëŠê¹€ ìƒíƒœì—ì„œ ì €ì¥

  - ê¸°ëŒ€ ê²°ê³¼: ì—ëŸ¬ Toast + ë°ì´í„° ì†ì‹¤ ì—†ìŒ (localStorage ë°±ì—…)

- [ ] **EC-03**: ë‹¤ë¥¸ ì‚¬ìš©ì ë¬¸ì„œ IDë¡œ ì ‘ê·¼ ì‹œë„

  - ê¸°ëŒ€ ê²°ê³¼: 404 Not Found (RLSê°€ ì°¨ë‹¨)

- [ ] **EC-04**: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë¬¸ì„œ IDë¡œ `/editor?id=xxx` ì ‘ê·¼
  - ê¸°ëŒ€ ê²°ê³¼: 404 ì•ˆë‚´ â†’ ìƒˆ ë¬¸ì„œ ëª¨ë“œë¡œ ì „í™˜ ë˜ëŠ” ëª©ë¡ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

---

## 4) ìµœì¢… íŒë‹¨ (Decision)

- [x] ìƒíƒœ ì„ íƒ: **âš ï¸ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìˆ˜ì • í›„ ì§„í–‰**

- [ ] **ê°€ì¥ ì¹˜ëª…ì ì¸ ê²°í•¨ 1ì¤„ ìš”ì•½**:
  > P3-03ì—ì„œ `useDocuments().saveDocument()` í˜¸ì¶œ íŒ¨í„´ì€ React Hooks ê·œì¹™ ìœ„ë°˜ì´ë©°, Document íƒ€ì… ì •ì˜(P3-00)ê°€ ëˆ„ë½ë˜ì–´ TypeScript ì»´íŒŒì¼ ì‹¤íŒ¨ ì˜ˆìƒ.

---

## ğŸ“ ìˆ˜ì • í•„ìˆ˜ í•­ëª© ìš”ì•½ (Priority Order)

| ìš°ì„ ìˆœìœ„ | í•­ëª©       | ìˆ˜ì • ë‚´ìš©                              |
| -------- | ---------- | -------------------------------------- |
| ğŸ”´ P0    | P3-00 ì‹ ê·œ | Document íƒ€ì… ì •ì˜ ì¶”ê°€                |
| ğŸ”´ P0    | P3-03 ìˆ˜ì • | Hooks íŒ¨í„´ ìˆ˜ì • (ì»´í¬ë„ŒíŠ¸ ìµœìƒìœ„ ì„ ì–¸) |
| ğŸŸ  P1    | P2-01~04   | Supabase ì¸ì¦ ì½”ë“œ íŒ¨í„´ ëª…ì‹œ           |
| ğŸŸ  P1    | P1-01      | user_id, updated_at ì¸ë±ìŠ¤ ì¶”ê°€        |
| ğŸŸ¡ P2    | P5-00 ì‹ ê·œ | localStorage ë§ˆì´ê·¸ë ˆì´ì…˜ ë¡œì§         |
| ğŸŸ¡ P2    | P4-03      | searchParams ì ‘ê·¼ ë°©ì‹ ëª…ì‹œ            |
