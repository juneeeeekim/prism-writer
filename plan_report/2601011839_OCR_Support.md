# OCR 지원 설계 문서

> **문서 ID**: 2601011839_OCR_Support  
> **작성일**: 2026-01-01  
> **우선순위**: 4순위  
> **예상 소요**: 2주  
> **필요 인프라**: Vision API (비용 발생)

---

## 1. 현재 상태

- PDF 텍스트 추출: `pdf2json` 사용
- **스캔된 이미지 PDF: 지원 안 됨**
- 사용자 요청: "스캔한 계약서 처리 안 돼요"

---

## 2. 목표

| 파일 유형         | 현재 | 목표 |
| :---------------- | :--: | :--: |
| 텍스트 PDF        |  ✅  |  ✅  |
| 스캔 PDF          |  ❌  |  ✅  |
| 이미지 (JPG, PNG) |  ❌  |  ✅  |

---

## 3. 기술 선택

| 서비스            | 가격           | 한글 지원 |
| :---------------- | :------------- | :-------: |
| **OpenAI GPT-4V** | $0.01/이미지   |   우수    |
| Google Vision     | $0.0015/이미지 |   우수    |

**권장**: OpenAI GPT-4V (기존 키 활용)

---

## 4. 구현 개요

```
1. PDF 업로드
2. 텍스트 추출 시도
3. 텍스트 없음 → OCR 모드
4. PDF → 이미지 변환 (페이지별)
5. Vision API 호출
6. 텍스트 병합 → 청킹
```

### 주요 파일

- `lib/rag/ocr.ts` (신규): OCR 모듈
- `documentProcessor.ts` (수정): OCR 폴백

---

## 5. 비용 분석

| 시나리오     | 페이지 |  비용 |
| :----------- | :----: | ----: |
| 10페이지 PDF |   10   | $0.10 |
| 월 1,000문서 | 10,000 |  $100 |

**비용 제어**: 무료 10페이지 제한, 사용자 동의 필수

---

## 6. 리스크

| 리스크    | 대응             |
| :-------- | :--------------- |
| 비용 폭주 | 페이지/일일 제한 |
| 처리 시간 | QStash 큐 분리   |

---

## 7. 결론

**추천: ⭐⭐⭐☆☆ (조건부)**

- 사용자 요청 많으면 도입
- B2B 고객 대상 시 유용
- **비용 관리 필수**
